Create Batch
------------

Create a Batch to run up to 15,000 Searches (100 when adding searches with `include_html=true` set) on a schedule. You can have up to 10,000 Batches set up on your SerpWow account at any one time.

Batches are created by making an`HTTP POST`to the`/batches`endpoint. POST parameters can be either supplied as`x-www-form-urlencoded`parameters or by POST'ing a`JSON`object to the`/batches`endpoint.

  
:::hint



**Using `include_html=true` in Batches**  
When adding searches with `include_html=true` to a Batch the maximum number of searches per Batch is 100 (rather than 15,000) because including the HTML within the response makes the Batch Result Sets much larger. The limit is in place to ensure Result Set files are of a manageable size. If you have need to run a large number of searches all with `include_html=true` then simply split the searches across multiple 100-search Batches.  
:::

### Example

POST`/batches`Let's start with a simple example; we'll create a Batch that is set to run every day at 9am and 5pm. We'll use the`notification_email`parameter to specify an email address to send notifications to (when the Batch completes), the`notification_as_csv`parameter to request the Batch results be delivered in CSV format and the `destination_ids`parameter to request that the Result Sets generated by running the Batch be uploaded to the specified Destination ID of "ABCDEFG":





image/svg+xml
































CurlNode.JSPythonPHP  
:::::codeblocktabs


```
$ curl "https://api.serpwow.com/live/batches?api_key=demo" \
  -d name="My First Batch" \
  -d enabled=true \
  -d schedule_type="daily" \
  -d priority="normal" \
  -d schedule_hours="9,17" \
  -d destination_ids="ABCDEFG" \
  -d notification_email="john.smith@example.com" \
  -d notification_as_csv=true
```

```
const axios = require('axios');
const body = {
  name: 'My First Batch',
  enabled: true,
  schedule_type: 'daily',
  priority: 'normal',
  schedule_hours: [9,17],
  destination_ids: [ 'ABCDEFG' ],
  notification_email: 'john.smith@example.com',
  notification_as_csv: true
}

axios.post('https://api.serpwow.com/live/batches?api_key=demo', body)
  .then(response => {
    const apiResponse = response.data;

    console.log('Batch Created: ' + JSON.stringify(apiResponse, 0, 2));

  }).catch(error => {
    console.log(error);
  });
```

```
import requests

body = {
  "name": "My First Batch",
  "enabled": True,
  "schedule_type": "daily",
  "priority": "normal",
  "schedule_hours": [9,17],
  "destination_ids": [ "ABCDEFG" ],
  "notification_email": "john.smith@example.com",
  "notification_as_csv": True
}

api_result = requests.post('https://api.serpwow.com/live/batches?api_key=demo', json=body)

api_response = api_result.json()

print "Batch Created: ", json.dumps(api_response)
```

```
<?php

$body = http_build_query([
  "name" => "My First Batch",
  "enabled" => True,
  "schedule_type" => "daily",
  "priority" => "normal",
  "schedule_hours" => "9,17",
  "destination_ids" => "ABCDEFG",
  "notification_email" => "john.smith@example.com",
  "notification_as_csv" => True
]);

$ch = curl_init('https://api.serpwow.com/live/batches?api_key=demo');
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
# the following options are required if you're using an outdated OpenSSL version
# more details: https://www.openssl.org/blog/blog/2021/09/13/LetsEncryptRootCertExpire/
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($ch, CURLOPT_TIMEOUT, 180);
curl_setopt($ch, CURLOPT_CUSTOMREQUEST, "POST");
curl_setopt($ch, CURLOPT_POSTFIELDS, $body);

$json = curl_exec($ch);
curl_close($ch);

$api_result = json_decode($json, true);

print_r($api_result);

echo "Batch Created", PHP_EOL;

?>
```
  
:::::

CopySerpWow responds with the following JSON confirming the Batch has been successfully created. Note the Batch`id`, you'll use the Batch ID in subsequent calls to [update](/docs/batches-api/batches/update), [delete](/docs/batches-api/batches/delete) and [add Searches](/docs/batches-api/searches/create) to the Batch.


```
{
  "request_info": {
    "success": true
  },
  "batch": {
    "id": "F994420D",
    "created_at": "2020-01-01:00:00.000Z",
    "name": "My First Batch",
    "schedule_type": "daily",
    "priority": "normal",
    "schedule_hours": [
      9,
      17
    ],
    "destination_ids": [
      "ABCDEFG"
    ],
    "enabled": true,
    "status": "idle",
    "search_total_count": 0,
    "search_page_count": 0,
    "next_result_set_id": 1,
    "results_count": 0,
    "notification_email": "john.smith@example.com",
    "notification_as_json": false,
    "notification_as_csv": true,
    "search_type": "mixed",
    "search_type_locked": false
  }
}
```
Copy### Scheduling Batches

Batches can be scheduled on a monthly, weekly or daily basis. You can also set a Batch to be started manually, either via the [SerpWow Dashboard](https://app.serpwow.com/batches) or the [Start Batch API](/docs/batches-api/batches/start).

A Batches' schedule is defined by the`schedule_type`parameter. The values of`schedule_type`, and other associated parameters are shown below:

  
:::hint



Batch schedules are executed in the timezone set up on your [profile](https://app.serpwow.com/profile)  
:::

| schedule\_type | Scheduling Parameters |
| --- | --- |
| monthly | schedule\_days\_of\_monthArray of days of the month to run the Batch, i.e.[1,20]for the 1st & 20thschedule\_hoursArray of hours of the day to run the Batch, i.e.[9,17]for 9am & 5pm |
| weekly | schedule\_days\_of\_weekArray of days of the week (as integers) to run the Batch where 0=Sunday and 6=Saturday, i.e.[0,2]for Sunday & Tuesdayschedule\_hoursArray of hours of the day to run the Batch, i.e.[9,17]for 9am & 5pm |
| daily | schedule\_hoursArray of hours of the day to run the Batch, i.e.[9,17]for 9am & 5pm |
| manual | Whenschedule\_type=manualthe Batch must be manually started, either via the SerpWow Dashboard or the Start Batch API. |
### Batch Parameters

POST`/batches`The following parameters can be used when creating a Batch. The `api_key` parameter should be supplied as a querystring parameter on the request URL.

Parameters other than `api_key` should be supplied in either `x-www-form-urlencoded`  or `JSON` format, in the request body.

| Parameter | Required | Description |
| --- | --- | --- |
| api\_key | required | The API key for your account, should be supplied on the request querystring, i.e.api\_key=demo |
| name | required | The name of the Batch. |
| enabled | optional | Determines whether the Batch is enabled or not. Disabled Batches do not automatically start on their schedule.Parameter ValuestrueBatch is enabledfalseBatch is disabled |
| schedule\_type | optional | Determines the type of schedule the Batches uses.Parameter ValuesmonthlyBatch is run on a monthly schedule, useschedule\_days\_of\_monthto determine which days of the month andschedule\_hoursto determine which hours on those days.weeklyBatch is run on a weekly schedule, useschedule\_days\_of\_weekto determine which days of the week andschedule\_hoursto determine which hours on those days.dailyBatch is run on a daily schedule, useschedule\_hoursto determine which hours of the day the Batch is run.minutesBatch is run on a Per X Minutes schedule, useschedule\_minutesto determine the minutes frequency that the Batch is run. You may optionally use schedule\_hours, schedule\_days\_of\_week and schedule\_days\_of\_month to refine the hours of the day, days of the week or days of the month that you wish the Per X Minutes schedule to be run.manualBatch is run manually, use the SerpWow Dashboard or the Start Batch API to start the Batch. |
| priority | optional | Determines the priority of the Batch. When multiple Batches are queued, SerpWow starts them in priority order. Learn more about priorities.Parameter Valueshighesthighnormallowlowest |
| schedule\_days\_of\_month | optional | Determines the days of the month the Batch is run when schedule\_type=monthly or schedule\_type=minutes, expressed as an array of integers, i.e.[1,3,20]for the 1st, 3rd and 20th of the month.NoteWhen using schedule\_days\_of\_month in combination with schedule\_type=minutes the Batch is executed at the per-minute frequency set in schedule\_minutes on the days of the month set in schedule\_days\_of\_month. For example, if you set schedule\_type=minutes, schedule\_minutes=every\_5\_minutes and schedule\_days\_of\_month=[1,3,20] your Batch would be run every 5 minutes on the 1st, 3rd and 20th of the month. When schedule\_type=minutes you can use either schedule\_days\_of\_month or schedule\_days\_of\_week, not both simultaneously. |
| schedule\_days\_of\_week | optional | Determines the days of the week the Batch is run when schedule\_type=weekly or schedule\_type=minutes, expressed as an array of integers where 0=Sunday and 6=Saturday, i.e.[0,2]for Sunday & Tuesday.NoteWhen using schedule\_days\_of\_week in combination with schedule\_type=minutes the Batch is executed at the per-minute frequency set in schedule\_minutes on the days of the week set in schedule\_days\_of\_week. For example, if you set schedule\_type=minutes, schedule\_minutes=every\_5\_minutes and schedule\_days\_of\_week=[0,2] your Batch would be run every 5 minutes on Sunday & Tuesday. When schedule\_type=minutes you can use either schedule\_days\_of\_week or schedule\_days\_of\_month, not both simultaneously. |
| schedule\_hours | optional | Determines the hours of the day the Batch is run when schedule\_type=minutes, schedule\_type=monthly, schedule\_type=weekly or schedule\_type=daily. Expressed as an array of integers between 0 (midnight) and 23 (11pm), i.e.[9,17]for 9am & 5pm.NoteBatch schedules are executed in the timezone set up on your profile.NoteWhen using schedule\_hours in combination with schedule\_type=minutes the Batch is executed at the per-minute frequency set in schedule\_minutes throughout the hours set in schedule\_hours. For example, if you set schedule\_type=minutes, schedule\_minutes=every\_5\_minutes and schedule\_hours=[10,11,12] your Batch would be run every 5 minutes between the hours of 10am and 1pm.If you wish for a schedule\_type=minutes Batch to be run continuously 24/7 then you shoud omit the schedule\_hours parameter. |
| schedule\_minutes | optional | Determines the minutes frequency that the Batch is run when schedule\_type=minutes.Parameter Valuesevery\_minuteRun the Batch every minuteevery\_5\_minutesRun the Batch every 5 minutesevery\_10\_minutesRun the Batch every 10 minutesevery\_15\_minutesRun the Batch every 15 minutesevery\_20\_minutesRun the Batch every 20 minutesevery\_25\_minutesRun the Batch every 25 minutesevery\_30\_minutesRun the Batch every 30 minutesevery\_hourRun the Batch every hourNoteWhen using schedule\_type=minutes Batches are run at the selected frequency 24/7 unless specific hours are chosen in the schedule\_hours parameter, specific days of the week are chosen in the schedule\_days\_of\_week parameter or specific days of the month are chosen in the schedule\_days\_of\_month parameter. |
| destination\_ids | optional | Specifies an array of Destination IDs (i.e. Amazon S3 Buckets, Google Cloud Storage buckets, Microsoft Azure Blob Storage or Alibaba Cloud OSS Buckets) that Result Sets from this Batch are uploaded to. Destination IDs can be retrieved through the Dashboard or via the Destinations API. |
| notification\_email | optional | The email address to send notifications to when new Result Sets are available for this Batch. |
| notification\_webhook | optional | The URL SerpWow will send a webhook POST to when new Result Sets are available for this Batch. Should be a fully qualified URL, i.e.https://yourserver.com/serpwow |
| notification\_as\_json | optional | Determines whether SerpWow sends download links (in the email notification ifnotification\_emailis set, or in the body of the webhook POST ifnotification\_webhookis set) for the Batch Result Sets in JSON format, or not.If destination\_ids are configured for this Batch then this setting determines whether Result Set files in JSON format are uploaded to the Destinations on Batch completion.Parameter ValuestrueJSON output format enabled / sentfalseJSON output format disabled / not sent |
| notification\_as\_jsonlines | optional | Determines whether SerpWow sends download links (in the email notification ifnotification\_emailis set, or in the body of the webhook POST ifnotification\_webhookis set) for the Batch Result Sets in JSON Lines format, or not.If destination\_ids are configured for this Batch then this setting determines whether Result Set files in JSON Lines format are uploaded to the Destinations on Batch completion.Parameter ValuestrueJSON Lines output format enabled / sentfalseJSON Lines output format disabled / not sent |
| notification\_as\_csv | optional | Determines whether sends download links (in the email notification ifnotification\_emailis set, or in the body of the webhook POST ifnotification\_webhookis set) for the Batch Result Sets CSV format, or not. To set the CSV fields included in the Result Set use thecsv\_fieldsparameter.If destination\_ids are configured for this Batch then this setting determines whether Result Set files in CSV format are uploaded to the Destinations on Batch completion.Parameter ValuestrueCSV output format enabled / sentfalseCSV output format disabled / not sent |
| notification\_csv\_fields | optional | Determines the fields that are returned whennotification\_as\_csv=true. Should be specified as a comma seperated list of fields (in nested field, dot notation, format). For more information see the CSV Fields Reference. |
| searches\_type | optional | Determines whether this Batch is locked to only allow searches of the specified type to be added to it.Locking a Batch to a specific search type has several benefits including allowing SerpWow to automatically choose the correct CSV fields, appropriate to the searches in the Batch, to be selected by default when exporting a Result Set in CSV mode. It can also help organize your account when you have many Batches set up.To allow any searches type to be added either omit searches\_type entirely, or set it to mixed.When set, the searches\_type\_locked=true property is present when retrieving the Batch letting you know that the Batch is locked.If you leave the Batch as unlocked (i.e. by setting searches\_type=mixed) then searches\_type\_locked=false will be present when retrieving the Batch and searches\_type will be set to either mixed (in the case of the Batch containing mixed searches types) or a searches\_type value automatically detected based on the type of searches that have been subsequently added to the Batch.Note The searches\_type cannot be changed after the Batch is created.For more information see the Batch Locking documentation.Valid values for searches\_type are:Parameter ValuesmixedAllow searches of any type to be added to this Batch.google\_webLock the Batch to allow only searches of type 'google\_web' to be added.google\_newsLock the Batch to allow only searches of type 'google\_news' to be added.google\_imagesLock the Batch to allow only searches of type 'google\_images' to be added.google\_videosLock the Batch to allow only searches of type 'google\_videos' to be added.google\_placesLock the Batch to allow only searches of type 'google\_places' to be added.google\_trendsLock the Batch to allow only searches of type 'google\_trends' to be added.google\_shoppingLock the Batch to allow only searches of type 'google\_shopping' to be added.google\_autocompleteLock the Batch to allow only searches of type 'google\_autocomplete' to be added.google\_place\_detailsLock the Batch to allow only searches of type 'google\_place\_details' to be added.google\_place\_photosLock the Batch to allow only searches of type 'google\_place\_photos' to be added.google\_place\_reviewsLock the Batch to allow only searches of type 'google\_place\_reviews' to be added.google\_place\_productsLock the Batch to allow only searches of type 'google\_place\_products' to be added.google\_place\_postsLock the Batch to allow only searches of type 'google\_place\_posts' to be added.google\_scholarLock the Batch to allow only searches of type 'google\_scholar' to be added.google\_product\_productLock the Batch to allow only searches of type 'google\_product\_product' to be added.google\_product\_sellers\_onlineLock the Batch to allow only searches of type 'google\_product\_sellers\_online' to be added.google\_product\_sellers\_localLock the Batch to allow only searches of type 'google\_product\_sellers\_local' to be added.google\_product\_reviewsLock the Batch to allow only searches of type 'google\_product\_reviews' to be added.google\_product\_specificationsLock the Batch to allow only searches of type 'google\_product\_specifications' to be added.bing\_webLock the Batch to allow only searches of type 'bing\_web' to be added.bing\_newsLock the Batch to allow only searches of type 'bing\_news' to be added.yahoo\_webLock the Batch to allow only searches of type 'yahoo\_web' to be added.yahoo\_newsLock the Batch to allow only searches of type 'yahoo\_news' to be added.naver\_webLock the Batch to allow only searches of type 'naver\_web' to be added.naver\_newsLock the Batch to allow only searches of type 'naver\_news' to be added.ebay\_webLock the Batch to allow only searches of type 'ebay\_web' to be added.amazon\_webLock the Batch to allow only searches of type 'amazon\_web' to be added.baidu\_webLock the Batch to allow only searches of type 'baidu\_web' to be added.yandex\_webLock the Batch to allow only searches of type 'yandex\_web' to be added. |
Next Steps

* [Update Batches](/docs/batches-api/batches/update)
